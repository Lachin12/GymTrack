<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GymTrack</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Custom styles */
        .slide-in {
            animation: slideIn 0.3s forwards;
        }
        
        .slide-out {
            animation: slideOut 0.3s forwards;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }
        
        @keyframes slideOut {
            from { transform: translateX(0); }
            to { transform: translateX(100%); }
        }
        
        .fade-in {
            animation: fadeIn 0.3s forwards;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .max-h-0 {
            max-height: 0;
        }
        
        .max-h-screen {
            max-height: 100vh;
        }
        
        .transition-max-height {
            transition: max-height 0.3s ease-out;
        }
        
        /* Theme toggle animation */
        .theme-toggle {
            transition: all 0.3s ease;
        }
        
        .theme-toggle:hover {
            transform: scale(1.1);
        }
        
        .theme-toggle:active {
            transform: scale(0.95);
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100 transition-colors duration-300">
    <div id="app" class="min-h-screen flex flex-col">
        <!-- Auth Screen -->
        <div id="auth-screen" class="fixed inset-0 bg-gray-100 dark:bg-gray-900 z-50 flex flex-col items-center justify-center p-4">
            <div class="w-full max-w-md bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8">
                <h1 class="text-3xl font-bold text-center mb-8">GymTrack</h1>
                
                <div id="auth-forms">
                    <!-- Login Form -->
                    <form id="login-form" class="space-y-4">
                        <div>
                            <label for="login-email" class="block text-sm font-medium mb-1">Email</label>
                            <input type="email" id="login-email" required class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 dark:bg-gray-700">
                        </div>
                        <div>
                            <label for="login-password" class="block text-sm font-medium mb-1">Password</label>
                            <input type="password" id="login-password" required class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 dark:bg-gray-700">
                        </div>
                        <button type="submit" class="w-full bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-md transition duration-300">Login</button>
                        <p class="text-center text-sm">
                            Don't have an account? 
                            <button type="button" id="show-signup" class="text-green-600 dark:text-green-400 font-medium">Sign up</button>
                        </p>
                    </form>
                    
                    <!-- Signup Form (hidden by default) -->
                    <form id="signup-form" class="space-y-4 hidden">
                        <div>
                            <label for="signup-name" class="block text-sm font-medium mb-1">Name</label>
                            <input type="text" id="signup-name" required class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 dark:bg-gray-700">
                        </div>
                        <div>
                            <label for="signup-email" class="block text-sm font-medium mb-1">Email</label>
                            <input type="email" id="signup-email" required class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 dark:bg-gray-700">
                        </div>
                        <div>
                            <label for="signup-password" class="block text-sm font-medium mb-1">Password</label>
                            <input type="password" id="signup-password" required class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 dark:bg-gray-700">
                        </div>
                        <div>
                            <label for="signup-confirm" class="block text-sm font-medium mb-1">Confirm Password</label>
                            <input type="password" id="signup-confirm" required class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 dark:bg-gray-700">
                        </div>
                        <button type="submit" class="w-full bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-md transition duration-300">Sign Up</button>
                        <p class="text-center text-sm">
                            Already have an account? 
                            <button type="button" id="show-login" class="text-green-600 dark:text-green-400 font-medium">Login</button>
                        </p>
                    </form>
                </div>
            </div>
        </div>
        
        <!-- Main App (hidden until authenticated) -->
        <div id="main-app" class="hidden flex-1">
            <!-- Header -->
            <header class="bg-white dark:bg-gray-800 shadow-sm p-4 flex justify-between items-center">
                <h1 class="text-xl font-bold">My Workout Plan</h1>
                <div class="flex items-center space-x-4">
                    <!-- Theme Toggle Button -->
                    <button id="theme-toggle" class="theme-toggle flex items-center justify-center w-10 h-10 rounded-full bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-yellow-300 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors duration-300">
                        <i id="theme-icon" class="fas fa-moon"></i>
                    </button>
                    
                    <!-- User Menu -->
                    <div class="relative">
                        <button id="user-menu-button" class="flex items-center space-x-2 focus:outline-none">
                            <div class="w-8 h-8 rounded-full bg-green-500 flex items-center justify-center text-white font-bold">
                                <span id="user-initial">U</span>
                            </div>
                        </button>
                        <div id="user-menu" class="hidden absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-md shadow-lg py-1 z-10">
                            <button id="logout-button" class="block w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700">Logout</button>
                        </div>
                    </div>
                </div>
            </header>
            
            <!-- Main Content -->
            <main class="flex-1 overflow-hidden">
                <!-- Week Navigation -->
                <div class="bg-white dark:bg-gray-800 shadow-sm p-2 overflow-x-auto">
                    <div class="flex space-x-1 min-w-max">
                        <button class="day-tab px-4 py-2 rounded-md font-medium" data-day="monday">Monday</button>
                        <button class="day-tab px-4 py-2 rounded-md font-medium" data-day="tuesday">Tuesday</button>
                        <button class="day-tab px-4 py-2 rounded-md font-medium" data-day="wednesday">Wednesday</button>
                        <button class="day-tab px-4 py-2 rounded-md font-medium" data-day="thursday">Thursday</button>
                        <button class="day-tab px-4 py-2 rounded-md font-medium" data-day="friday">Friday</button>
                        <button class="day-tab px-4 py-2 rounded-md font-medium" data-day="saturday">Saturday</button>
                        <button class="day-tab px-4 py-2 rounded-md font-medium" data-day="sunday">Sunday</button>
                    </div>
                </div>
                
                <!-- Current Day Exercises -->
                <div id="day-exercises" class="p-4">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-lg font-bold" id="current-day">Monday</h2>
                        <button id="add-exercise-btn" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md flex items-center space-x-2 transition duration-300">
                            <i class="fas fa-plus"></i>
                            <span>Add Exercise</span>
                        </button>
                    </div>
                    
                    <div id="exercises-list" class="space-y-3">
                        <!-- Exercises will be added here dynamically -->
                        <div class="text-center py-8 text-gray-500">
                            <p>No exercises added for this day.</p>
                            <p>Click "Add Exercise" to get started!</p>
                        </div>
                    </div>
                </div>
            </main>
            
            <!-- Exercise Library Modal -->
            <div id="exercise-library" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center hidden">
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-md max-h-[80vh] overflow-hidden mx-4">
                    <div class="p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                        <h3 class="text-lg font-bold">Exercise Library</h3>
                        <button id="close-library" class="text-gray-500 hover:text-gray-700 dark:hover:text-gray-300">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="p-4">
                        <div class="mb-4">
                            <label for="muscle-group-filter" class="block text-sm font-medium mb-1">Filter by Muscle Group</label>
                            <select id="muscle-group-filter" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 dark:bg-gray-700">
                                <option value="all">All Muscle Groups</option>
                                <option value="chest">Chest</option>
                                <option value="back">Back</option>
                                <option value="legs">Legs</option>
                                <option value="shoulders">Shoulders</option>
                                <option value="arms">Arms</option>
                                <option value="core">Core</option>
                                <option value="cardio">Cardio</option>
                            </select>
                        </div>
                        
                        <div id="library-exercises" class="space-y-2 max-h-[60vh] overflow-y-auto">
                            <!-- Exercises will be added here dynamically -->
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Exercise Details Modal -->
            <div id="exercise-details" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center hidden">
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-md max-h-[80vh] overflow-hidden mx-4">
                    <div class="p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                        <h3 class="text-lg font-bold" id="exercise-details-title">Exercise Details</h3>
                        <button id="close-details" class="text-gray-500 hover:text-gray-700 dark:hover:text-gray-300">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="p-4 space-y-4 max-h-[60vh] overflow-y-auto">
                        <div>
                            <h4 class="font-medium">Muscle Group:</h4>
                            <p id="exercise-muscle-group" class="text-gray-700 dark:text-gray-300"></p>
                        </div>
                        
                        <div>
                            <h4 class="font-medium">Equipment:</h4>
                            <p id="exercise-equipment" class="text-gray-700 dark:text-gray-300"></p>
                        </div>
                        
                        <div>
                            <h4 class="font-medium">Instructions:</h4>
                            <p id="exercise-instructions" class="text-gray-700 dark:text-gray-300"></p>
                        </div>
                        
                        <div class="pt-4">
                            <label for="exercise-sets" class="block text-sm font-medium mb-1">Sets</label>
                            <input type="number" id="exercise-sets" min="1" value="3" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 dark:bg-gray-700">
                        </div>
                        
                        <div>
                            <label for="exercise-reps" class="block text-sm font-medium mb-1">Reps</label>
                            <input type="text" id="exercise-reps" value="8-12" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 dark:bg-gray-700">
                        </div>
                        
                        <div>
                            <label for="exercise-notes" class="block text-sm font-medium mb-1">Notes</label>
                            <textarea id="exercise-notes" rows="3" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 dark:bg-gray-700"></textarea>
                        </div>
                        
                        <button id="save-exercise" class="w-full bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-md transition duration-300">Add to Workout</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Database of exercises
        const exerciseLibrary = [
            // Chest exercises
            { id: 1, name: "Bench Press", muscleGroup: "chest", equipment: "Barbell", instructions: "Lie on a flat bench with feet flat on the floor. Grip the barbell slightly wider than shoulder-width. Lower the bar to your chest, then press it back up." },
            { id: 2, name: "Dumbbell Fly", muscleGroup: "chest", equipment: "Dumbbells", instructions: "Lie on a flat bench with a dumbbell in each hand. With a slight bend in your elbows, lower the weights out to your sides in an arc motion. Bring them back up over your chest." },
            { id: 3, name: "Incline Bench Press", muscleGroup: "chest", equipment: "Barbell", instructions: "Lie on an incline bench set at 30-45 degrees. Grip the barbell slightly wider than shoulder-width. Lower the bar to your upper chest, then press it back up." },
            { id: 4, name: "Push-ups", muscleGroup: "chest", equipment: "Bodyweight", instructions: "Start in a plank position with hands slightly wider than shoulder-width. Lower your body until your chest nearly touches the floor, then push back up." },
            { id: 5, name: "Chest Dips", muscleGroup: "chest", equipment: "Parallel bars", instructions: "Hold yourself up on parallel bars with arms straight. Lean forward slightly and lower your body by bending your elbows. Push back up to the starting position." },
            
            // Back exercises
            { id: 6, name: "Deadlift", muscleGroup: "back", equipment: "Barbell", instructions: "Stand with feet hip-width apart, bend at hips and knees to grip the bar. Keep back straight as you lift the bar by extending hips and knees. Lower back down with control." },
            { id: 7, name: "Pull-ups", muscleGroup: "back", equipment: "Pull-up bar", instructions: "Grab the bar with hands wider than shoulder-width. Pull your body up until your chin is above the bar, then lower back down with control." },
            { id: 8, name: "Bent-over Row", muscleGroup: "back", equipment: "Barbell", instructions: "Stand with feet shoulder-width apart, knees slightly bent. Bend at hips to lower torso until nearly parallel to floor. Pull barbell to your waist, then lower back down." },
            { id: 9, name: "Lat Pulldown", muscleGroup: "back", equipment: "Cable machine", instructions: "Sit at lat pulldown machine with hands wider than shoulder-width on the bar. Pull the bar down to your chest, then slowly return to starting position." },
            { id: 10, name: "Seated Row", muscleGroup: "back", equipment: "Cable machine", instructions: "Sit at cable row machine with feet on footrests. Grab the handle and pull it towards your waist while keeping back straight. Slowly return to starting position." },
            
            // Leg exercises
            { id: 11, name: "Squat", muscleGroup: "legs", equipment: "Barbell", instructions: "Stand with feet shoulder-width apart. Place barbell on upper back. Bend at knees and hips to lower body as far as possible, then push back up to standing." },
            { id: 12, name: "Leg Press", muscleGroup: "legs", equipment: "Leg press machine", instructions: "Sit in leg press machine with feet shoulder-width apart on platform. Push platform away by extending knees and hips, then slowly return to starting position." },
            { id: 13, name: "Lunges", muscleGroup: "legs", equipment: "Dumbbells", instructions: "Stand with feet together holding dumbbells. Step forward with one leg and lower until both knees are bent at 90 degrees. Push back to starting position and alternate legs." },
            { id: 14, name: "Leg Curl", muscleGroup: "legs", equipment: "Leg curl machine", instructions: "Lie face down on leg curl machine with ankles under pad. Curl legs up by bending knees, then slowly lower back down." },
            { id: 15, name: "Calf Raises", muscleGroup: "legs", equipment: "Bodyweight or dumbbells", instructions: "Stand on edge of step with heels hanging off. Raise up on toes as high as possible, then lower heels below step level." },
            
            // Shoulders exercises
            { id: 16, name: "Overhead Press", muscleGroup: "shoulders", equipment: "Barbell", instructions: "Stand with feet shoulder-width apart. Hold barbell at shoulder height. Press the bar overhead until arms are straight, then lower back to shoulders." },
            { id: 17, name: "Lateral Raises", muscleGroup: "shoulders", equipment: "Dumbbells", instructions: "Stand with dumbbells at sides. Raise arms out to sides until parallel to floor, then slowly lower back down." },
            { id: 18, name: "Front Raises", muscleGroup: "shoulders", equipment: "Dumbbells", instructions: "Stand with dumbbells in front of thighs. Raise arms forward until parallel to floor, then slowly lower back down." },
            { id: 19, name: "Rear Delt Fly", muscleGroup: "shoulders", equipment: "Dumbbells", instructions: "Bend at hips with dumbbells hanging down. Raise arms out to sides with elbows slightly bent, squeezing shoulder blades together. Slowly lower back down." },
            { id: 20, name: "Shrugs", muscleGroup: "shoulders", equipment: "Dumbbells or barbell", instructions: "Stand with weights at sides. Lift shoulders up towards ears, hold briefly, then lower back down." },
            
            // Arms exercises
            { id: 21, name: "Bicep Curl", muscleGroup: "arms", equipment: "Dumbbells", instructions: "Stand with dumbbells at sides, palms facing forward. Curl weights up towards shoulders, then slowly lower back down." },
            { id: 22, name: "Hammer Curl", muscleGroup: "arms", equipment: "Dumbbells", instructions: "Stand with dumbbells at sides, palms facing in. Curl weights up keeping palms facing each other, then slowly lower back down." },
            { id: 23, name: "Tricep Dips", muscleGroup: "arms", equipment: "Parallel bars or bench", instructions: "Hold yourself up on parallel bars or bench with arms straight. Lower body by bending elbows, then push back up." },
            { id: 24, name: "Tricep Pushdown", muscleGroup: "arms", equipment: "Cable machine", instructions: "Stand at cable machine with rope attachment. Push rope down by extending elbows, keeping upper arms stationary. Slowly return to starting position." },
            { id: 25, name: "Preacher Curl", muscleGroup: "arms", equipment: "Barbell or dumbbells", instructions: "Sit at preacher bench with arms resting on pad. Curl weight up, then slowly lower back down." },
            
            // Core exercises
            { id: 26, name: "Plank", muscleGroup: "core", equipment: "Bodyweight", instructions: "Hold a push-up position with weight on forearms. Keep body straight from head to heels. Hold for time." },
            { id: 27, name: "Hanging Leg Raises", muscleGroup: "core", equipment: "Pull-up bar", instructions: "Hang from pull-up bar. Raise legs up until thighs are parallel to floor, then slowly lower back down." },
            { id: 28, name: "Russian Twists", muscleGroup: "core", equipment: "Dumbbell or medicine ball", instructions: "Sit on floor with knees bent, holding weight. Lean back slightly and twist torso side to side, touching weight to floor each side." },
            { id: 29, name: "Cable Woodchoppers", muscleGroup: "core", equipment: "Cable machine", instructions: "Stand sideways to cable machine with high attachment. Pull cable down and across body in chopping motion, then slowly return." },
            { id: 30, name: "Ab Wheel Rollouts", muscleGroup: "core", equipment: "Ab wheel", instructions: "Kneel holding ab wheel handles. Roll wheel forward while keeping core tight, then pull back to starting position." },
            
            // Cardio exercises
            { id: 31, name: "Treadmill Running", muscleGroup: "cardio", equipment: "Treadmill", instructions: "Set treadmill to desired speed and incline. Run for time or distance." },
            { id: 32, name: "Rowing Machine", muscleGroup: "cardio", equipment: "Rowing machine", instructions: "Sit on rower with feet strapped in. Push with legs while pulling handle to chest, then return to starting position." },
            { id: 33, name: "Jump Rope", muscleGroup: "cardio", equipment: "Jump rope", instructions: "Hold rope handles and swing rope over head. Jump as rope passes under feet." },
            { id: 34, name: "Stationary Bike", muscleGroup: "cardio", equipment: "Exercise bike", instructions: "Sit on bike and pedal at desired resistance for time or distance." },
            { id: 35, name: "Stair Climber", muscleGroup: "cardio", equipment: "Stair climber machine", instructions: "Step on machine and climb at desired speed for time." }
        ];
        // App state
        let currentUser = null;
        let currentDay = "monday";
        let selectedExercise = null;
        let workoutPlan = {
            monday: [],
            tuesday: [],
            wednesday: [],
            thursday: [],
            friday: [],
            saturday: [],
            sunday: []
        };
        // DOM elements
        const authScreen = document.getElementById('auth-screen');
        const mainApp = document.getElementById('main-app');
        const loginForm = document.getElementById('login-form');
        const signupForm = document.getElementById('signup-form');
        const showSignup = document.getElementById('show-signup');
        const showLogin = document.getElementById('show-login');
        const logoutButton = document.getElementById('logout-button');
        const userMenuButton = document.getElementById('user-menu-button');
        const userMenu = document.getElementById('user-menu');
        const userInitial = document.getElementById('user-initial');
        const themeToggleBtn = document.getElementById('theme-toggle');
        const themeIcon = document.getElementById('theme-icon');
        const dayTabs = document.querySelectorAll('.day-tab');
        const currentDayDisplay = document.getElementById('current-day');
        const exercisesList = document.getElementById('exercises-list');
        const addExerciseBtn = document.getElementById('add-exercise-btn');
        const exerciseLibraryModal = document.getElementById('exercise-library');
        const closeLibrary = document.getElementById('close-library');
        const muscleGroupFilter = document.getElementById('muscle-group-filter');
        const libraryExercises = document.getElementById('library-exercises');
        const exerciseDetailsModal = document.getElementById('exercise-details');
        const closeDetails = document.getElementById('close-details');
        const exerciseDetailsTitle = document.getElementById('exercise-details-title');
        const exerciseMuscleGroup = document.getElementById('exercise-muscle-group');
        const exerciseEquipment = document.getElementById('exercise-equipment');
        const exerciseInstructions = document.getElementById('exercise-instructions');
        const exerciseSets = document.getElementById('exercise-sets');
        const exerciseReps = document.getElementById('exercise-reps');
        const exerciseNotes = document.getElementById('exercise-notes');
        const saveExerciseBtn = document.getElementById('save-exercise');
        // Initialize app
        document.addEventListener('DOMContentLoaded', () => {
            // Check for saved user data
            const savedUserData = localStorage.getItem('gymPlannerUserData');
            if (savedUserData) {
                try {
                    const users = JSON.parse(savedUserData);
                    // For demo purposes, we'll just check if there's any user
                    if (users && users.length > 0) {
                        // Auto-login the first user (for demo)
                        currentUser = users[0];
                        userInitial.textContent = currentUser.name.charAt(0).toUpperCase();
                        authScreen.classList.add('hidden');
                        mainApp.classList.remove('hidden');
                        loadWorkoutPlan();
                        updateDayExercises();
                    }
                } catch (e) {
                    console.error('Error parsing user data:', e);
                }
            }
            // Set initial theme
            if (localStorage.getItem('darkMode') === 'true') {
                document.documentElement.classList.add('dark');
                themeIcon.classList.remove('fa-moon');
                themeIcon.classList.add('fa-sun');
            } else {
                document.documentElement.classList.remove('dark');
                themeIcon.classList.remove('fa-sun');
                themeIcon.classList.add('fa-moon');
            }
        });
        // Event listeners
        showSignup.addEventListener('click', () => {
            loginForm.classList.add('hidden');
            signupForm.classList.remove('hidden');
        });
        showLogin.addEventListener('click', () => {
            signupForm.classList.add('hidden');
            loginForm.classList.remove('hidden');
        });
        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            
            // In a real app, you would validate credentials properly
            const savedUserData = localStorage.getItem('gymPlannerUserData');
            if (savedUserData) {
                try {
                    const users = JSON.parse(savedUserData);
                    const user = users.find(u => u.email === email && u.password === password);
                    
                    if (user) {
                        currentUser = user;
                        userInitial.textContent = user.name.charAt(0).toUpperCase();
                        authScreen.classList.add('hidden');
                        mainApp.classList.remove('hidden');
                        loadWorkoutPlan();
                        updateDayExercises();
                    } else {
                        alert('Invalid email or password');
                    }
                } catch (e) {
                    console.error('Error parsing user data:', e);
                    alert('Error logging in');
                }
            } else {
                alert('No user found with that email');
            }
        });
        signupForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const name = document.getElementById('signup-name').value;
            const email = document.getElementById('signup-email').value;
            const password = document.getElementById('signup-password').value;
            const confirm = document.getElementById('signup-confirm').value;
            
            if (password !== confirm) {
                alert('Passwords do not match');
                return;
            }
            
            // Save user data
            let users = [];
            const savedUserData = localStorage.getItem('gymPlannerUserData');
            if (savedUserData) {
                try {
                    users = JSON.parse(savedUserData);
                } catch (e) {
                    console.error('Error parsing user data:', e);
                }
            }
            
            // Check if email already exists
            if (users.some(u => u.email === email)) {
                alert('Email already in use');
                return;
            }
            
            const newUser = { name, email, password };
            users.push(newUser);
            
            try {
                localStorage.setItem('gymPlannerUserData', JSON.stringify(users));
                currentUser = newUser;
                userInitial.textContent = name.charAt(0).toUpperCase();
                authScreen.classList.add('hidden');
                mainApp.classList.remove('hidden');
                loadWorkoutPlan();
                updateDayExercises();
                
                // Reset forms
                signupForm.reset();
                signupForm.classList.add('hidden');
                loginForm.classList.remove('hidden');
            } catch (e) {
                console.error('Error saving user data:', e);
                alert('Error creating account');
            }
        });
        logoutButton.addEventListener('click', () => {
            currentUser = null;
            mainApp.classList.add('hidden');
            authScreen.classList.remove('hidden');
            loginForm.reset();
            signupForm.reset();
            signupForm.classList.add('hidden');
            loginForm.classList.remove('hidden');
        });
        userMenuButton.addEventListener('click', () => {
            userMenu.classList.toggle('hidden');
        });
        // Close user menu when clicking outside
        document.addEventListener('click', (e) => {
            if (!userMenuButton.contains(e.target) && !userMenu.contains(e.target)) {
                userMenu.classList.add('hidden');
            }
        });
        themeToggleBtn.addEventListener('click', () => {
            if (document.documentElement.classList.contains('dark')) {
                document.documentElement.classList.remove('dark');
                localStorage.setItem('darkMode', 'false');
                themeIcon.classList.remove('fa-sun');
                themeIcon.classList.add('fa-moon');
            } else {
                document.documentElement.classList.add('dark');
                localStorage.setItem('darkMode', 'true');
                themeIcon.classList.remove('fa-moon');
                themeIcon.classList.add('fa-sun');
            }
        });
        dayTabs.forEach(tab => {
            tab.addEventListener('click', () => {
                currentDay = tab.dataset.day;
                updateDayExercises();
                
                // Update active tab styling
                dayTabs.forEach(t => t.classList.remove('bg-green-100', 'dark:bg-green-900', 'text-green-800', 'dark:text-green-200'));
                tab.classList.add('bg-green-100', 'dark:bg-green-900', 'text-green-800', 'dark:text-green-200');
            });
        });
        // Set Monday as active by default
        dayTabs[0].classList.add('bg-green-100', 'dark:bg-green-900', 'text-green-800', 'dark:text-green-200');
        addExerciseBtn.addEventListener('click', () => {
            openExerciseLibrary();
        });
        closeLibrary.addEventListener('click', () => {
            exerciseLibraryModal.classList.add('hidden');
        });
        muscleGroupFilter.addEventListener('change', () => {
            populateExerciseLibrary();
        });
        closeDetails.addEventListener('click', () => {
            exerciseDetailsModal.classList.add('hidden');
        });
        saveExerciseBtn.addEventListener('click', () => {
            if (selectedExercise) {
                const exerciseToAdd = {
                    ...selectedExercise,
                    sets: exerciseSets.value,
                    reps: exerciseReps.value,
                    notes: exerciseNotes.value
                };
                
                workoutPlan[currentDay].push(exerciseToAdd);
                saveWorkoutPlan();
                updateDayExercises();
                exerciseDetailsModal.classList.add('hidden');
                
                // Reset form
                exerciseSets.value = '3';
                exerciseReps.value = '8-12';
                exerciseNotes.value = '';
            }
        });
        // Functions
        function loadWorkoutPlan() {
            if (currentUser) {
                const savedPlan = localStorage.getItem(`gymPlannerWorkoutPlan_${currentUser.email}`);
                if ( savedPlan) {
                    try {
                        workoutPlan = JSON.parse(savedPlan);
                    } catch (e) {
                        console.error('Error parsing workout plan:', e);
                    }
                }
            }
        }
        function saveWorkoutPlan() {
            if (currentUser) {
                localStorage.setItem(`gymPlannerWorkoutPlan_${currentUser.email}`, JSON.stringify(workoutPlan));
            }
        }
        function updateDayExercises() {
            currentDayDisplay.textContent = currentDay.charAt(0).toUpperCase() + currentDay.slice(1);
            
            const exercises = workoutPlan[currentDay];
            exercisesList.innerHTML = '';
            
            if (exercises.length === 0) {
                exercisesList.innerHTML = `
                    <div class="text-center py-8 text-gray-500">
                        <p>No exercises added for this day.</p>
                        <p>Click "Add Exercise" to get started!</p>
                    </div>
                `;
                return;
            }
            
            exercises.forEach((exercise, index) => {
                const exerciseElement = document.createElement('div');
                exerciseElement.className = 'bg-white dark:bg-gray-800 rounded-lg shadow p-4 border border-gray-200 dark:border-gray-700';
                exerciseElement.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div>
                            <h3 class="font-bold">${exercise.name}</h3>
                            <p class="text-sm text-gray-600 dark:text-gray-400">${exercise.muscleGroup.charAt(0).toUpperCase() + exercise.muscleGroup.slice(1)} • ${exercise.sets} sets × ${exercise.reps} reps</p>
                        </div>
                        <div class="flex space-x-2">
                            <button class="view-exercise-btn text-green-600 dark:text-green-400" data-index="${index}">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="delete-exercise-btn text-red-600 dark:text-red-400" data-index="${index}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    ${exercise.notes ? `<div class="mt-2 text-sm text-gray-700 dark:text-gray-300">${exercise.notes}</div>` : ''}
                `;
                
                exercisesList.appendChild(exerciseElement);
            });
            
            // Add event listeners to new buttons
            document.querySelectorAll('.view-exercise-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const index = e.currentTarget.dataset.index;
                    viewExerciseDetails(index);
                });
            });
            
            document.querySelectorAll('.delete-exercise-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const index = e.currentTarget.dataset.index;
                    deleteExercise(index);
                });
            });
        }
        function openExerciseLibrary() {
            populateExerciseLibrary();
            exerciseLibraryModal.classList.remove('hidden');
        }
        function populateExerciseLibrary() {
            const filter = muscleGroupFilter.value;
            let exercisesToShow = exerciseLibrary;
            
            if (filter !== 'all') {
                exercisesToShow = exerciseLibrary.filter(ex => ex.muscleGroup === filter);
            }
            
            libraryExercises.innerHTML = '';
            
            exercisesToShow.forEach(exercise => {
                const exerciseElement = document.createElement('div');
                exerciseElement.className = 'bg-white dark:bg-gray-700 rounded-lg shadow p-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 transition duration-200';
                exerciseElement.innerHTML = `
                    <h4 class="font-medium">${exercise.name}</h4>
                    <p class="text-sm text-gray-600 dark:text-gray-300">${exercise.muscleGroup.charAt(0).toUpperCase() + exercise.muscleGroup.slice(1)} • ${exercise.equipment}</p>
                `;
                
                exerciseElement.addEventListener('click', () => {
                    selectExercise(exercise);
                });
                
                libraryExercises.appendChild(exerciseElement);
            });
        }
        function selectExercise(exercise) {
            selectedExercise = exercise;
            exerciseLibraryModal.classList.add('hidden');
            
            // Populate exercise details modal
            exerciseDetailsTitle.textContent = exercise.name;
            exerciseMuscleGroup.textContent = exercise.muscleGroup.charAt(0).toUpperCase() + exercise.muscleGroup.slice(1);
            exerciseEquipment.textContent = exercise.equipment;
            exerciseInstructions.textContent = exercise.instructions;
            
            exerciseDetailsModal.classList.remove('hidden');
        }
        function viewExerciseDetails(index) {
            const exercise = workoutPlan[currentDay][index];
            selectedExercise = exercise;
            
            // Populate exercise details modal
            exerciseDetailsTitle.textContent = exercise.name;
            exerciseMuscleGroup.textContent = exercise.muscleGroup.charAt(0).toUpperCase() + exercise.muscleGroup.slice(1);
            exerciseEquipment.textContent = exercise.equipment;
            exerciseInstructions.textContent = exercise.instructions;
            exerciseSets.value = exercise.sets;
            exerciseReps.value = exercise.reps;
            exerciseNotes.value = exercise.notes || '';
            
            // Change button text since we're viewing an existing exercise
            saveExerciseBtn.textContent = 'Update Exercise';
            
            // Store the index so we can update the correct exercise
            saveExerciseBtn.dataset.index = index;
            
            exerciseDetailsModal.classList.remove('hidden');
            
            // Update the event listener for save button
            saveExerciseBtn.onclick = function() {
                const updatedExercise = {
                    ...selectedExercise,
                    sets: exerciseSets.value,
                    reps: exerciseReps.value,
                    notes: exerciseNotes.value
                };
                
                workoutPlan[currentDay][index] = updatedExercise;
                saveWorkoutPlan();
                updateDayExercises();
                exerciseDetailsModal.classList.add('hidden');
                
                // Reset button text and remove index
                saveExerciseBtn.textContent = 'Add to Workout';
                delete saveExerciseBtn.dataset.index;
                
                // Reset the event listener
                saveExerciseBtn.onclick = function() {
                    if (selectedExercise) {
                        const exerciseToAdd = {
                            ...selectedExercise,
                            sets: exerciseSets.value,
                            reps: exerciseReps.value,
                            notes: exerciseNotes.value
                        };
                        
                        workoutPlan[currentDay].push(exerciseToAdd);
                        saveWorkoutPlan();
                        updateDayExercises();
                        exerciseDetailsModal.classList.add('hidden');
                        
                        // Reset form
                        exerciseSets.value = '3';
                        exerciseReps.value = '8-12';
                        exerciseNotes.value = '';
                    }
                };
            };
        }
        function deleteExercise(index) {
            if (confirm('Are you sure you want to delete this exercise?')) {
                workoutPlan[currentDay].splice(index, 1);
                saveWorkoutPlan();
                updateDayExercises();
            }
        }
    </script>
<p style="border-radius: 8px; text-align: center; font-size: 12px; color: #fff; margin-top: 16px;position: fixed; left: 8px; bottom: 8px; z-index: 10; background: rgba(0, 0, 0, 0.8); padding: 4px 8px;">Made with <img src="https://enzostvs-deepsite.hf.space/logo.svg" alt="DeepSite Logo" style="width: 16px; height: 16px; vertical-align: middle;display:inline-block;margin-right:3px;filter:brightness(0) invert(1);"><a href="https://enzostvs-deepsite.hf.space" style="color: #fff;text-decoration: underline;" target="_blank" >DeepSite</a> - <a href="https://enzostvs-deepsite.hf.space?remix=Lachin12/gymtrack2" style="color: #fff;text-decoration: underline;" target="_blank" >🧬 Remix</a></p></body>
</html>
